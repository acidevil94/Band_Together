
<div class="row">
  <h2 align="center">Sign up</h2>
<div class="col-md-6 col-md-offset-3">

  <%= form_for(resource, as: resource_name, url: registration_path(resource_name)) do |f| %>
    <%= devise_error_messages! %>

    <div class="field">
      <%= f.label :username %><br />
      <%= f.text_field :username, autofocus: true, class: 'form-control' %>
    </div>
<br />
    <div class="field">
      <%= f.label :email %><br />
      <%= f.email_field :email , class: 'form-control' %>
    </div>
<br />
    <div class="field">
      <%= f.label :password %>
      <% if @minimum_password_length %>
      <em>(<%= @minimum_password_length %> characters minimum)</em>
      <% end %><br />
      <%= f.password_field :password, autocomplete: "off", class: 'form-control'  %>
    </div>
<br />
    <div class="field">
      <%= f.label :password_confirmation %><br />
      <%= f.password_field :password_confirmation, autocomplete: "off", class: 'form-control'  %>
    </div>
<br />
    <div class="field">
      <%= f.label :first_name , "First name"%><br />
      <%= f.text_field :first_name , class: 'form-control' %>
    </div>
<br />
    <div class="field">
      <%= f.label :last_name , "Last name"%><br />
      <%= f.text_field :last_name , class: 'form-control' %>
    </div>
<br />

  <div class="field">
    <%= f.label :gender, "Gender"%><br />
    <%= f.select(:gender, options_for_select([["Male","M"],["Female","F"]] ), {}, {:class => 'form-control'})  %>

    </div>
<br />
    <div class="field">
      <%= f.label :birth , "Birth date"%><br />
      <%= f.text_field :birth, "data-provide" => 'datepicker' , class: 'form-control' %>
    </div>



    <br>

  <!--

      I campi della nazione e della regione sono stati modificati e sono diventati delle select. Il campo della regione si basa sul valore scelto
      dall'utente nel campo nazione per mostreare le regioni della nazione scelta

      RezeR
  -->

    <%= f.label :nation , "Nation"%><br />
    <div class="field">
      <select id="countries" name="nation" class="form-control">
        <option value="" selected="">Select country</option>}
        <% CS.countries.each do |key, value| %>
        <option value="<%= key %>"><%= value %></option>
        <% end %>
      </select>

      <br/>

  <%= f.label :region , "Region"%><br />
      <select name="region" id="states-of-country" class="form-control">
        <option value="" selected="">Select state/province</option>
      </select>


      <!-- Script che genera la select "region" quando viene selezionata una nazione nella select "nation" - RezeR -->

      <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js" type="text/javascript"></script>

      <script>
        $('#countries').change(function(){
          $("#user_nation").val($(this).find(":selected").text()); //Setta il value del campo hidden nation al valore selezionato nella select "nation"
          $.getJSON('/states/' + $(this).val() , function(data){
            $('#states-of-country').empty();
            $.each(data, function(i, ele){
              var opt = '<option value='+ ele +'>' + ele + '</option>';
              $('#states-of-country').append(opt);
            });
            $("#user_region").val($('#states-of-country').find(":selected").text()); //Setta il value del campo hidden region al primo valore selezionato nella select "region"
          });
        });
      </script>

      <!-- Script che setta il value del campo hidden "region" quando viene selezionata una nuova regione (diversa dalla prima) nella select "region" - RezeR -->

      <script>
        $('#states-of-country').change(function(){
          $("#user_region").val($(this).find(":selected").text());
        });
      </script>





    </div>


    <br>

    <!--
    I due campi hidden "nation" e "region" servono per salvare i valori della nazione e della regione selezioni e che verranno passati alla POST.
    RezeR
    -->

    <div class="field">
      <%= f.hidden_field :nation %>
      <%= f.hidden_field :region %>
    </div>

    <div class="field">
      <%= f.label :type_of_musician, "Instrument played" %><br/>

      <%= f.select(:type_of_musician, options_for_select(["Drummer", ["Lead Guitar", "Lead_guitarist"], ["Rhythm Guitar", "Rhythmic_guitarist"], ["Bass", "Bass_guitarist"], "Keyboardist", "Singer", "Winds"] ), {}, {:class => 'form-control'})  %>

    </div>

    <br>

    <div class="field">
      <%= f.label :musical_genre, "Favourite musical genre" %><br/>
      <%= f.select(:musical_genre, options_for_select(["Rock", "Metal", "Jazz", "Blues", "Pop", "Classic", "Latin"] ), {}, {:class => 'form-control'})  %>

    </div>

    <br>

    <div class="actions" align="center">
      <%= f.submit "Sign up", :id => "SignUp" ,:class => "btn btn-primary btn-md"%>
    </div>
    <% end %>
<br/>
  <div>
        <%= link_to "Sign in with Google", user_google_oauth2_omniauth_authorize_path %>
        <br/>
        <%= link_to "Sign in with Facebook", user_facebook_omniauth_authorize_path %>
  </div>
</div>
</div>
